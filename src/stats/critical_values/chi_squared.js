import { getCriticalValue, getCriticalValuesMap } from './map.js'

/* eslint-disable max-lines */
// Return number to multiply variance with in order to get its confidence
// interval for a given significance level and size.
// Uses the chi-squared distribution's critical value.
export const getChiSquaredValue = (size, significanceLevel) => {
  const degreesOfFreedom = size - 1
  const criticalValue = getCriticalValue(
    CHI_SQUARED_MAP,
    degreesOfFreedom,
    significanceLevel,
  )
  return degreesOfFreedom / criticalValue
}

// Chi-squared critical values, with specific significance level, single-sided
// TODO: more digits of precision
// TODO: more values
/* eslint-disable unicorn/numeric-separators-style */
const CHI_SQUARED_RAW = [
  {
    significanceLevel: 0.025,
    getMaxValue: (degreesOfFreedom) => degreesOfFreedom + 1,
    criticalValues: {
      1: 5.024,
      2: 7.378,
      3: 9.348,
      4: 11.143,
      5: 12.833,
      6: 14.449,
      7: 16.013,
      8: 17.535,
      9: 19.023,
      10: 20.483,
      11: 21.92,
      12: 23.337,
      13: 24.736,
      14: 26.119,
      15: 27.488,
      16: 28.845,
      17: 30.191,
      18: 31.526,
      19: 32.852,
      20: 34.17,
      21: 35.479,
      22: 36.781,
      23: 38.076,
      24: 39.364,
      25: 40.646,
      26: 41.923,
      27: 43.195,
      28: 44.461,
      29: 45.722,
      30: 46.979,
      31: 48.232,
      32: 49.48,
      33: 50.725,
      34: 51.966,
      35: 53.203,
      36: 54.437,
      37: 55.668,
      38: 56.896,
      39: 58.12,
      40: 59.342,
      41: 60.561,
      42: 61.777,
      43: 62.99,
      44: 64.201,
      45: 65.41,
      46: 66.617,
      47: 67.821,
      48: 69.023,
      49: 70.222,
      50: 71.42,
      51: 72.616,
      52: 73.81,
      53: 75.002,
      54: 76.192,
      55: 77.38,
      56: 78.567,
      57: 79.752,
      58: 80.936,
      59: 82.117,
      60: 83.298,
      61: 84.476,
      62: 85.654,
      63: 86.83,
      64: 88.004,
      65: 89.177,
      66: 90.349,
      67: 91.519,
      68: 92.689,
      69: 93.856,
      70: 95.023,
      71: 96.189,
      72: 97.353,
      73: 98.516,
      74: 99.678,
      75: 100.839,
      76: 101.999,
      77: 103.158,
      78: 104.316,
      79: 105.473,
      80: 106.629,
      81: 107.783,
      82: 108.937,
      83: 110.09,
      84: 111.242,
      85: 112.393,
      86: 113.544,
      87: 114.693,
      88: 115.841,
      89: 116.989,
      90: 118.136,
      91: 119.282,
      92: 120.427,
      93: 121.571,
      94: 122.715,
      95: 123.858,
      96: 125,
      97: 126.141,
      98: 127.282,
      99: 128.422,
      100: 129.561,
      101: 130.7,
      102: 131.838,
      103: 132.975,
      104: 134.111,
      105: 135.247,
      106: 136.382,
      107: 137.517,
      108: 138.651,
      109: 139.784,
      110: 140.917,
      111: 142.049,
      112: 143.18,
      113: 144.311,
      114: 145.441,
      115: 146.571,
      116: 147.7,
      117: 148.829,
      118: 149.957,
      119: 151.084,
      120: 152.211,
      121: 153.338,
      122: 154.464,
      123: 155.589,
      124: 156.714,
      125: 157.839,
      126: 158.962,
      127: 160.086,
      128: 161.209,
      129: 162.331,
      130: 163.453,
      131: 164.575,
      132: 165.696,
      133: 166.816,
      134: 167.936,
      135: 169.056,
      136: 170.175,
      137: 171.294,
      138: 172.412,
      139: 173.53,
      140: 174.648,
      141: 175.765,
      142: 176.882,
      143: 177.998,
      144: 179.114,
      145: 180.229,
      146: 181.344,
      147: 182.459,
      148: 183.573,
      149: 184.687,
      150: 185.8,
      151: 186.914,
      152: 188.026,
      153: 189.139,
      154: 190.251,
      155: 191.362,
      156: 192.474,
      157: 193.584,
      158: 194.695,
      159: 195.805,
      160: 196.915,
      161: 198.025,
      162: 199.134,
      163: 200.243,
      164: 201.351,
      165: 202.459,
      166: 203.567,
      167: 204.675,
      168: 205.782,
      169: 206.889,
      170: 207.995,
      171: 209.102,
      172: 210.208,
      173: 211.313,
      174: 212.419,
      175: 213.524,
      176: 214.628,
      177: 215.733,
      178: 216.837,
      179: 217.941,
      180: 219.044,
      181: 220.148,
      182: 221.251,
      183: 222.353,
      184: 223.456,
      185: 224.558,
      186: 225.66,
      187: 226.761,
      188: 227.863,
      189: 228.964,
      190: 230.064,
      191: 231.165,
      192: 232.265,
      193: 233.365,
      194: 234.465,
      195: 235.564,
      196: 236.664,
      197: 237.763,
      198: 238.861,
      199: 239.96,
      200: 241.058,
      201: 242.156,
      202: 243.254,
      203: 244.351,
      204: 245.448,
      205: 246.545,
      206: 247.642,
      207: 248.739,
      208: 249.835,
      209: 250.931,
      210: 252.027,
      211: 253.122,
      212: 254.218,
      213: 255.313,
      214: 256.408,
      215: 257.503,
      216: 258.597,
      217: 259.691,
      218: 260.785,
      219: 261.879,
      220: 262.973,
      221: 264.066,
      222: 265.159,
      223: 266.252,
      224: 267.345,
      225: 268.438,
      226: 269.53,
      227: 270.622,
      228: 271.714,
      229: 272.806,
      230: 273.898,
      231: 274.989,
      232: 276.08,
      233: 277.171,
      234: 278.262,
      235: 279.352,
      236: 280.443,
      237: 281.533,
      238: 282.623,
      239: 283.713,
      240: 284.802,
      241: 285.892,
      242: 286.981,
      243: 288.07,
      244: 289.159,
      245: 290.248,
      246: 291.336,
      247: 292.425,
      248: 293.513,
      249: 294.601,
      250: 295.689,
      300: 349.874,
      350: 403.723,
      400: 457.305,
      450: 510.67,
      500: 563.852,
      550: 616.878,
      600: 669.769,
      650: 722.542,
      700: 775.211,
      750: 827.785,
      800: 880.275,
      850: 932.689,
      900: 985.032,
      950: 1037.31,
      1000: 1089.53,
      10000: 10_279.7,
      100000: 100_885,
      1000000: 1_002_805,
    },
  },
  {
    significanceLevel: 0.975,
    getMaxValue: (degreesOfFreedom) => degreesOfFreedom - 1,
    criticalValues: {
      1: 0.000982,
      2: 0.0506,
      3: 0.216,
      4: 0.484,
      5: 0.831,
      6: 1.237,
      7: 1.69,
      8: 2.18,
      9: 2.7,
      10: 3.247,
      11: 3.816,
      12: 4.404,
      13: 5.009,
      14: 5.629,
      15: 6.262,
      16: 6.908,
      17: 7.564,
      18: 8.231,
      19: 8.907,
      20: 9.591,
      21: 10.283,
      22: 10.982,
      23: 11.689,
      24: 12.401,
      25: 13.12,
      26: 13.844,
      27: 14.573,
      28: 15.308,
      29: 16.047,
      30: 16.791,
      31: 17.539,
      32: 18.291,
      33: 19.047,
      34: 19.806,
      35: 20.569,
      36: 21.336,
      37: 22.106,
      38: 22.878,
      39: 23.654,
      40: 24.433,
      41: 25.215,
      42: 25.999,
      43: 26.785,
      44: 27.575,
      45: 28.366,
      46: 29.16,
      47: 29.956,
      48: 30.755,
      49: 31.555,
      50: 32.357,
      51: 33.162,
      52: 33.968,
      53: 34.776,
      54: 35.586,
      55: 36.398,
      56: 37.212,
      57: 38.027,
      58: 38.844,
      59: 39.662,
      60: 40.482,
      61: 41.303,
      62: 42.126,
      63: 42.95,
      64: 43.776,
      65: 44.603,
      66: 45.431,
      67: 46.261,
      68: 47.092,
      69: 47.924,
      70: 48.758,
      71: 49.592,
      72: 50.428,
      73: 51.265,
      74: 52.103,
      75: 52.942,
      76: 53.782,
      77: 54.623,
      78: 55.466,
      79: 56.309,
      80: 57.153,
      81: 57.998,
      82: 58.845,
      83: 59.692,
      84: 60.54,
      85: 61.389,
      86: 62.239,
      87: 63.089,
      88: 63.941,
      89: 64.793,
      90: 65.647,
      91: 66.501,
      92: 67.356,
      93: 68.211,
      94: 69.068,
      95: 69.925,
      96: 70.783,
      97: 71.642,
      98: 72.501,
      99: 73.361,
      100: 74.222,
      101: 75.083,
      102: 75.946,
      103: 76.809,
      104: 77.672,
      105: 78.536,
      106: 79.401,
      107: 80.267,
      108: 81.133,
      109: 82,
      110: 82.867,
      111: 83.735,
      112: 84.604,
      113: 85.473,
      114: 86.342,
      115: 87.213,
      116: 88.084,
      117: 88.955,
      118: 89.827,
      119: 90.7,
      120: 91.573,
      121: 92.446,
      122: 93.32,
      123: 94.195,
      124: 95.07,
      125: 95.946,
      126: 96.822,
      127: 97.698,
      128: 98.576,
      129: 99.453,
      130: 100.331,
      131: 101.21,
      132: 102.089,
      133: 102.968,
      134: 103.848,
      135: 104.729,
      136: 105.609,
      137: 106.491,
      138: 107.372,
      139: 108.254,
      140: 109.137,
      141: 110.02,
      142: 110.903,
      143: 111.787,
      144: 112.671,
      145: 113.556,
      146: 114.441,
      147: 115.326,
      148: 116.212,
      149: 117.098,
      150: 117.985,
      151: 118.871,
      152: 119.759,
      153: 120.646,
      154: 121.534,
      155: 122.423,
      156: 123.312,
      157: 124.201,
      158: 125.09,
      159: 125.98,
      160: 126.87,
      161: 127.761,
      162: 128.651,
      163: 129.543,
      164: 130.434,
      165: 131.326,
      166: 132.218,
      167: 133.111,
      168: 134.003,
      169: 134.897,
      170: 135.79,
      171: 136.684,
      172: 137.578,
      173: 138.472,
      174: 139.367,
      175: 140.262,
      176: 141.157,
      177: 142.053,
      178: 142.949,
      179: 143.845,
      180: 144.741,
      181: 145.638,
      182: 146.535,
      183: 147.432,
      184: 148.33,
      185: 149.228,
      186: 150.126,
      187: 151.024,
      188: 151.923,
      189: 152.822,
      190: 153.721,
      191: 154.621,
      192: 155.521,
      193: 156.421,
      194: 157.321,
      195: 158.221,
      196: 159.122,
      197: 160.023,
      198: 160.925,
      199: 161.826,
      200: 162.728,
      201: 163.63,
      202: 164.532,
      203: 165.435,
      204: 166.338,
      205: 167.241,
      206: 168.144,
      207: 169.047,
      208: 169.951,
      209: 170.855,
      210: 171.759,
      211: 172.664,
      212: 173.568,
      213: 174.473,
      214: 175.378,
      215: 176.283,
      216: 177.189,
      217: 178.095,
      218: 179.001,
      219: 179.907,
      220: 180.813,
      221: 181.72,
      222: 182.627,
      223: 183.534,
      224: 184.441,
      225: 185.348,
      226: 186.256,
      227: 187.164,
      228: 188.072,
      229: 188.98,
      230: 189.889,
      231: 190.797,
      232: 191.706,
      233: 192.615,
      234: 193.524,
      235: 194.434,
      236: 195.343,
      237: 196.253,
      238: 197.163,
      239: 198.073,
      240: 198.984,
      241: 199.894,
      242: 200.805,
      243: 201.716,
      244: 202.627,
      245: 203.539,
      246: 204.45,
      247: 205.362,
      248: 206.274,
      249: 207.186,
      250: 208.084,
      300: 253.912,
      350: 300.064,
      400: 346.482,
      450: 393.118,
      500: 439.936,
      550: 486.91,
      600: 534.019,
      650: 581.245,
      700: 628.577,
      750: 676.003,
      800: 723.513,
      850: 771.099,
      900: 818.756,
      950: 866.477,
      1000: 914.257,
      10000: 9723.8,
      100000: 99_125,
      1000000: 997_205,
    },
  },
]
/* eslint-enable unicorn/numeric-separators-style */

const CHI_SQUARED_MAP = getCriticalValuesMap(CHI_SQUARED_RAW)
/* eslint-enable max-lines */
